<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Compare Multiple Enrichment Results – EnrichGT</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-06d22339cf1bae60befde528b0c36036.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./EnrichGTlogo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">EnrichGT</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./pkgfuns.html"> 
<span class="menu-text">Package Functions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/ZhimingYe/EnrichGT/"> 
<span class="menu-text">Github</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./acknowledgement.html"> 
<span class="menu-text">Acknowledgement</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./compare.html">Compare Multiple Enrichment Results</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EnrichGT: all-in-one enrichment analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interfaceshiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web Interface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./enrichment_core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Enrichment Functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./re_enrichment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Second enrichment of enriched Results</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fusing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Functions to FUSING results</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize and Create Reports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./llm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Large language models integration</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./compare.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Compare Multiple Enrichment Results</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Select your databases for enrichment or annotation</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#comparison-reactor-user-guide" id="toc-comparison-reactor-user-guide" class="nav-link active" data-scroll-target="#comparison-reactor-user-guide">Comparison Reactor User Guide</a>
  <ul class="collapse">
  <li><a href="#ora-comparison-reactor" id="toc-ora-comparison-reactor" class="nav-link" data-scroll-target="#ora-comparison-reactor">ORA Comparison Reactor</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#basic-workflow" id="toc-basic-workflow" class="nav-link" data-scroll-target="#basic-workflow">Basic Workflow</a></li>
  </ul></li>
  <li><a href="#gsea-comparison-reactor" id="toc-gsea-comparison-reactor" class="nav-link" data-scroll-target="#gsea-comparison-reactor">GSEA Comparison Reactor</a>
  <ul class="collapse">
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1">Overview</a></li>
  <li><a href="#getting-started-1" id="toc-getting-started-1" class="nav-link" data-scroll-target="#getting-started-1">Getting Started</a></li>
  <li><a href="#basic-workflow-1" id="toc-basic-workflow-1" class="nav-link" data-scroll-target="#basic-workflow-1">Basic Workflow</a></li>
  </ul></li>
  <li><a href="#tips-and-best-practices" id="toc-tips-and-best-practices" class="nav-link" data-scroll-target="#tips-and-best-practices">Tips and Best Practices</a>
  <ul class="collapse">
  <li><a href="#for-both-ora-and-gsea" id="toc-for-both-ora-and-gsea" class="nav-link" data-scroll-target="#for-both-ora-and-gsea">For Both ORA and GSEA</a></li>
  <li><a href="#ora-specific-tips" id="toc-ora-specific-tips" class="nav-link" data-scroll-target="#ora-specific-tips">ORA-Specific Tips</a></li>
  <li><a href="#gsea-specific-tips" id="toc-gsea-specific-tips" class="nav-link" data-scroll-target="#gsea-specific-tips">GSEA-Specific Tips</a></li>
  </ul></li>
  <li><a href="#complete-example-workflows" id="toc-complete-example-workflows" class="nav-link" data-scroll-target="#complete-example-workflows">Complete Example Workflows</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#ora-workflow" id="toc-ora-workflow" class="nav-link" data-scroll-target="#ora-workflow">ORA Workflow</a></li>
  <li><a href="#gsea-workflow" id="toc-gsea-workflow" class="nav-link" data-scroll-target="#gsea-workflow">GSEA Workflow</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ZhimingYe/EnrichGT_website/blob/main/compare.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/ZhimingYe/EnrichGT_website/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Compare Multiple Enrichment Results</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="comparison-reactor-user-guide" class="level1">
<h1>Comparison Reactor User Guide</h1>
<p>The Comparison Reactor provides a framework for comparing and analyzing enrichment results across multiple experimental groups or conditions. It supports two types of enrichment analysis: Over-Representation Analysis (ORA) and Gene Set Enrichment Analysis (GSEA).</p>
<section id="ora-comparison-reactor" class="level2">
<h2 class="anchored" data-anchor-id="ora-comparison-reactor">ORA Comparison Reactor</h2>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<p>The ORA Comparison Reactor is designed for comparing over-representation analysis results across multiple groups. It focuses on p-value and adjusted p-value based comparisons to identify shared and unique enriched terms across different experimental conditions.</p>
</section>
<section id="getting-started" class="level3">
<h3 class="anchored" data-anchor-id="getting-started">Getting Started</h3>
<p>Create an ORA comparison reactor using:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ora_reactor <span class="ot">&lt;-</span> <span class="fu">egt_comparison_reactor</span>(<span class="st">"ORA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="basic-workflow" class="level3">
<h3 class="anchored" data-anchor-id="basic-workflow">Basic Workflow</h3>
<section id="adding-enrichment-results" class="level4">
<h4 class="anchored" data-anchor-id="adding-enrichment-results">1. Adding Enrichment Results</h4>
<p>Add your ORA enrichment results from different groups one by one. Each result must be a data frame containing p-value or adjusted p-value columns.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result1, <span class="st">"control"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result2, <span class="st">"treatment_A"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result3, <span class="st">"treatment_B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>x</code>: Data frame of enrichment results - <code>group</code>: Character string naming the group</p>
</section>
<section id="reviewing-your-data" class="level4">
<h4 class="anchored" data-anchor-id="reviewing-your-data">2. Reviewing Your Data</h4>
<p>Check which groups have been added to the reactor:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">summarize</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filtering-results" class="level4">
<h4 class="anchored" data-anchor-id="filtering-results">3. Filtering Results</h4>
<p>Filter your results by adjusted p-value to focus on the most significant terms:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">prefilter_by_p_adj</span>(<span class="fl">0.01</span>)  <span class="co"># Default is 0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>x</code>: Numeric cutoff for adjusted p-values (terms with p.adjust values below this threshold are retained)</p>
</section>
<section id="creating-comparison-plans" class="level4">
<h4 class="anchored" data-anchor-id="creating-comparison-plans">4. Creating Comparison Plans</h4>
<p>Set up the comparison framework by specifying which groups to compare and which statistical value to use:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">make_plans</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"treatment_A"</span>, <span class="st">"treatment_B"</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">use_value =</span> <span class="st">"padj"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>group</code>: Character vector of group names, or “auto” to include all groups - <code>use_value</code>: Either “p” (p-value) or “padj” (adjusted p-value) for comparisons</p>
</section>
<section id="finding-relationships-between-terms" class="level4">
<h4 class="anchored" data-anchor-id="finding-relationships-between-terms">5. Finding Relationships Between Terms</h4>
<p>Identify how enriched terms relate across your groups using hierarchical clustering:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">find_relationship</span>(<span class="at">Num =</span> <span class="dv">10</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">hclust_method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>Num</code>: Number of top terms to consider from each group - <code>dist_method</code>: Distance calculation method (e.g., “euclidean”, “manhattan”, “pearson”) - <code>hclust_method</code>: Hierarchical clustering method (e.g., “ward.D2”, “complete”, “average”) - <code>...</code>: Additional parameters passed to the heatmap visualization</p>
<p>This method performs clustering analysis and generates a heatmap visualization showing term relationships.</p>
</section>
<section id="retrieving-relationship-data" class="level4">
<h4 class="anchored" data-anchor-id="retrieving-relationship-data">6. Retrieving Relationship Data</h4>
<p>Extract the relationship analysis results as a data frame:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>relation_df <span class="ot">&lt;-</span> ora_reactor<span class="sc">$</span><span class="fu">fetch_relationship</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Returns:</strong> A data frame containing: - Term information - Statistical values across groups - Cluster assignments - Group presence indicators</p>
</section>
<section id="visualizing-biological-themes" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-biological-themes">7. Visualizing Biological Themes</h4>
<p>Generate word clouds to visualize the dominant biological themes in each cluster:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>wordclouds <span class="ot">&lt;-</span> ora_reactor<span class="sc">$</span><span class="fu">fetch_biological_theme</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>wordclouds[[<span class="dv">1</span>]]  <span class="co"># View word cloud for cluster 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Returns:</strong> A list of ggplot2 word cloud objects, one for each cluster</p>
</section>
<section id="splitting-by-cluster" class="level4">
<h4 class="anchored" data-anchor-id="splitting-by-cluster">8. Splitting by Cluster</h4>
<p>Organize your results by identified clusters for focused downstream analysis:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">split_by_cluster</span>()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cluster_list <span class="ot">&lt;-</span> ora_reactor<span class="sc">$</span><span class="fu">get_splited_list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Returns:</strong> A list of data frames, each containing terms belonging to a specific cluster</p>
</section>
<section id="sub-clustering-analysis" class="level4">
<h4 class="anchored" data-anchor-id="sub-clustering-analysis">9. Sub-clustering Analysis</h4>
<p>Perform deeper clustering within your existing clusters to identify finer biological themes:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">do_recluster</span>(<span class="at">ClusterNum =</span> <span class="dv">5</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">P.adj =</span> <span class="fl">0.05</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nTop =</span> <span class="dv">10</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>recluster_results <span class="ot">&lt;-</span> ora_reactor<span class="sc">$</span><span class="fu">get_recluster_result</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>ClusterNum</code>: Number of sub-clusters to generate - <code>P.adj</code>: Adjusted p-value cutoff for filtering terms before reclustering - <code>force</code>: Whether to force reclustering even if already performed (default: FALSE) - <code>nTop</code>: Number of top terms to consider from each original cluster - <code>method</code>: Clustering method</p>
<p><strong>Returns:</strong> A list containing: - Sub-cluster assignments - Updated term-cluster relationships - Sub-cluster specific visualizations</p>
<hr>
</section>
</section>
</section>
<section id="gsea-comparison-reactor" class="level2">
<h2 class="anchored" data-anchor-id="gsea-comparison-reactor">GSEA Comparison Reactor</h2>
<section id="overview-1" class="level3">
<h3 class="anchored" data-anchor-id="overview-1">Overview</h3>
<p>The GSEA Comparison Reactor is specialized for comparing Gene Set Enrichment Analysis results across multiple groups. It leverages Normalized Enrichment Scores (NES) to identify gene sets with consistent or divergent enrichment patterns across conditions.</p>
</section>
<section id="getting-started-1" class="level3">
<h3 class="anchored" data-anchor-id="getting-started-1">Getting Started</h3>
<p>Create a GSEA comparison reactor using:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor <span class="ot">&lt;-</span> <span class="fu">egt_comparison_reactor</span>(<span class="st">"GSEA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="basic-workflow-1" class="level3">
<h3 class="anchored" data-anchor-id="basic-workflow-1">Basic Workflow</h3>
<section id="adding-enrichment-results-1" class="level4">
<h4 class="anchored" data-anchor-id="adding-enrichment-results-1">1. Adding Enrichment Results</h4>
<p>Add your GSEA enrichment results from different groups. Each result must be a data frame containing NES values and p-value columns.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(gsea_result1, <span class="st">"condition1"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(gsea_result2, <span class="st">"condition2"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(gsea_result3, <span class="st">"condition3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>x</code>: Data frame of GSEA enrichment results - <code>group</code>: Character string naming the group</p>
</section>
<section id="reviewing-your-data-1" class="level4">
<h4 class="anchored" data-anchor-id="reviewing-your-data-1">2. Reviewing Your Data</h4>
<p>Check which groups have been added:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">summarize</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filtering-results-1" class="level4">
<h4 class="anchored" data-anchor-id="filtering-results-1">3. Filtering Results</h4>
<p>For GSEA, you can filter by either statistical significance or enrichment strength:</p>
<p><strong>Filter by adjusted p-value:</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">prefilter_by_p_adj</span>(<span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Filter by Normalized Enrichment Score:</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">prefilter_by_NES</span>(<span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - For <code>prefilter_by_p_adj()</code>: Numeric cutoff for adjusted p-values - For <code>prefilter_by_NES()</code>: Numeric cutoff for absolute NES values (both positive and negative)</p>
<p>Filtering by NES is particularly useful for focusing on gene sets with strong enrichment effects, regardless of statistical significance.</p>
</section>
<section id="creating-comparison-plans-1" class="level4">
<h4 class="anchored" data-anchor-id="creating-comparison-plans-1">4. Creating Comparison Plans</h4>
<p>Set up the comparison framework. For GSEA, the comparison typically uses NES values:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">make_plans</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">"condition1"</span>, <span class="st">"condition2"</span>, <span class="st">"condition3"</span>),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">use_value =</span> <span class="st">"NES"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>group</code>: Character vector of group names, or “auto” to include all groups - <code>use_value</code>: Typically “NES” (Normalized Enrichment Score) for GSEA comparisons</p>
</section>
<section id="finding-relationships-between-gene-sets" class="level4">
<h4 class="anchored" data-anchor-id="finding-relationships-between-gene-sets">5. Finding Relationships Between Gene Sets</h4>
<p>Identify patterns of gene set enrichment across your conditions:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">find_relationship</span>(<span class="at">Num =</span> <span class="dv">15</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dist_method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hclust_method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>Num</code>: Number of top gene sets to consider from each group - <code>dist_method</code>: Distance calculation method; “pearson” or “spearman” often work well for NES-based comparisons - <code>hclust_method</code>: Hierarchical clustering method - <code>...</code>: Additional parameters for heatmap visualization</p>
<p>This analysis reveals which gene sets show similar enrichment patterns across conditions, helping identify coordinated biological processes.</p>
</section>
<section id="retrieving-relationship-data-1" class="level4">
<h4 class="anchored" data-anchor-id="retrieving-relationship-data-1">6. Retrieving Relationship Data</h4>
<p>Extract the relationship analysis results:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>relation_df <span class="ot">&lt;-</span> gsea_reactor<span class="sc">$</span><span class="fu">fetch_relationship</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Returns:</strong> A data frame containing: - Gene set information - NES values across groups - Cluster assignments - Enrichment direction indicators</p>
</section>
<section id="visualizing-biological-themes-1" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-biological-themes-1">7. Visualizing Biological Themes</h4>
<p>Generate word clouds showing the predominant biological themes in each cluster:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wordclouds <span class="ot">&lt;-</span> gsea_reactor<span class="sc">$</span><span class="fu">fetch_biological_theme</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>wordclouds[[<span class="dv">1</span>]]  <span class="co"># View word cloud for cluster 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Returns:</strong> A list of ggplot2 word cloud objects</p>
<p>For GSEA results, word clouds help summarize the biological themes represented by gene sets showing similar enrichment patterns.</p>
</section>
<section id="splitting-by-cluster-1" class="level4">
<h4 class="anchored" data-anchor-id="splitting-by-cluster-1">8. Splitting by Cluster</h4>
<p>Organize results by clusters for detailed examination:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">split_by_cluster</span>()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cluster_list <span class="ot">&lt;-</span> gsea_reactor<span class="sc">$</span><span class="fu">get_splited_list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Returns:</strong> A list of data frames, each containing gene sets from a specific cluster</p>
<p>This is particularly useful for identifying gene sets that are: - Consistently enriched across all conditions - Specifically enriched in certain conditions - Showing opposite enrichment directions across conditions</p>
</section>
<section id="sub-clustering-analysis-1" class="level4">
<h4 class="anchored" data-anchor-id="sub-clustering-analysis-1">9. Sub-clustering Analysis</h4>
<p>Refine your clustering to identify subtle biological themes:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">do_recluster</span>(<span class="at">ClusterNum =</span> <span class="dv">8</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">P.adj =</span> <span class="fl">0.05</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nTop =</span> <span class="dv">15</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span> <span class="st">"complete"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>recluster_results <span class="ot">&lt;-</span> gsea_reactor<span class="sc">$</span><span class="fu">get_recluster_result</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters:</strong> - <code>ClusterNum</code>: Number of sub-clusters to generate - <code>P.adj</code>: Adjusted p-value cutoff for filtering - <code>force</code>: Whether to force reclustering (default: FALSE) - <code>nTop</code>: Number of top gene sets to consider from each original cluster - <code>method</code>: Clustering method</p>
<p><strong>Returns:</strong> A list containing sub-cluster assignments and refined term groupings</p>
<p>For GSEA, sub-clustering can help separate gene sets by: - Enrichment direction (upregulated vs downregulated) - Magnitude of enrichment - Condition-specific patterns</p>
<hr>
</section>
</section>
</section>
<section id="tips-and-best-practices" class="level2">
<h2 class="anchored" data-anchor-id="tips-and-best-practices">Tips and Best Practices</h2>
<section id="for-both-ora-and-gsea" class="level3">
<h3 class="anchored" data-anchor-id="for-both-ora-and-gsea">For Both ORA and GSEA</h3>
<ul>
<li><p><strong>Method Chaining</strong>: Most methods return the reactor object invisibly, allowing you to chain operations:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(result1, <span class="st">"group1"</span>)<span class="sc">$</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">append_enriched_result</span>(result2, <span class="st">"group2"</span>)<span class="sc">$</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prefilter_by_p_adj</span>(<span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>Filtering Strategy</strong>: Apply filtering before finding relationships to focus computational resources on significant terms</p></li>
<li><p><strong>Cluster Number Selection</strong>: Start with the default clustering, examine the results, then adjust <code>ClusterNum</code> in reclustering based on biological interpretation</p></li>
</ul>
</section>
<section id="ora-specific-tips" class="level3">
<h3 class="anchored" data-anchor-id="ora-specific-tips">ORA-Specific Tips</h3>
<ul>
<li>Use “padj” rather than “p” for more robust comparisons when dealing with multiple testing</li>
<li>Consider stricter p-value cutoffs (e.g., 0.01) when comparing many groups to reduce noise</li>
</ul>
</section>
<section id="gsea-specific-tips" class="level3">
<h3 class="anchored" data-anchor-id="gsea-specific-tips">GSEA-Specific Tips</h3>
<ul>
<li>NES filtering is powerful for identifying strongly enriched gene sets; typical cutoffs range from 1.0 to 2.0</li>
<li>Consider using correlation-based distance metrics (“pearson”, “spearman”) when comparing NES patterns</li>
<li>Pay attention to enrichment direction; positive and negative NES values represent different biological states</li>
</ul>
<hr>
</section>
</section>
<section id="complete-example-workflows" class="level2">
<h2 class="anchored" data-anchor-id="complete-example-workflows">Complete Example Workflows</h2>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(org.Hs.eg.db)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnrichGT)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>fulllist <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./cprreactorFile.rds"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>ora_result_g1 <span class="ot">&lt;-</span> fulllist[[<span class="dv">1</span>]]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>ora_result_g2 <span class="ot">&lt;-</span> fulllist[[<span class="dv">2</span>]]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>ora_result_g3 <span class="ot">&lt;-</span> fulllist[[<span class="dv">3</span>]]</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>ora_result_g4 <span class="ot">&lt;-</span> fulllist[[<span class="dv">4</span>]]</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>ora_result_g5 <span class="ot">&lt;-</span> fulllist[[<span class="dv">5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>reactor1 <span class="ot">&lt;-</span> <span class="fu">egt_comparison_reactor</span>(<span class="st">"ora"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── EnrichGT comparison reactor ─────────────────────────────────────────────────</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result_g1, <span class="st">"liver_GO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Appended data into group liver_GO.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result_g2, <span class="st">"kidney_GO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Overlap rate of new added data and the latest data:52.13%.
Please ensure there are overlaps among appended data. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Appended data into group kidney_GO.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result_g3, <span class="st">"muscle_GO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Overlap rate of new added data and the latest data:65.17%.
Please ensure there are overlaps among appended data. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Appended data into group muscle_GO.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result_g4, <span class="st">"pancreas_GO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Overlap rate of new added data and the latest data:69.76%.
Please ensure there are overlaps among appended data. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Appended data into group pancreas_GO.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">append_enriched_result</span>(ora_result_g5, <span class="st">"spleen_GO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Overlap rate of new added data and the latest data:57.58%.
Please ensure there are overlaps among appended data. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Appended data into group spleen_GO.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">prefilter_by_p_adj</span>(<span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Filter according to p adjust &lt; 0.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">make_plans</span>(<span class="fu">c</span>(<span class="st">"liver_GO"</span>, <span class="st">"kidney_GO"</span>, <span class="st">"spleen_GO"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Successed. 
If the result is strange, please remember do prefiltering by `reactor$prefilter_by...()`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">find_relationship</span>(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Clustering with euclidean distance and ward.D2 linkage, cut into 6 clusters</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>clusters
  1   2   3   4   5   6 
 14  24  61 129 192  19 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="compare_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Suggest include: 1,2,3,4,5,6</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Suggest exclude: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>figlist0 <span class="ot">&lt;-</span> reactor1<span class="sc">$</span><span class="fu">fetch_biological_theme</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Suggest include: 1,2,3,4,5,6
✖ Suggest exclude: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Will return a figure list.
Please assign to any value use `figlist &lt;- reactor$fetch_biological_theme()`, and draw individual by printing them inside this list. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>figlist0[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="compare_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">split_by_cluster</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Suggest include: 1,2,3,4,5,6</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Suggest exclude: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>reactor1<span class="sc">$</span><span class="fu">do_recluster</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Too many clusters! Try with max as ncol/10...
use force=T to forbid the self-check</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Too many clusters! Try with max as ncol/10...
use force=T to forbid the self-check</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ re-enrichment done.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ You can adjust the param of egt_recluster_analysis() for better results. Please refer to the help page. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> reactor1<span class="sc">$</span><span class="fu">get_recluster_result</span>()</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(res,<span class="at">max.level=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 17
 $ Data:liver_GO,Cluster:1   :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:pancreas_GO,Cluster:1:Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:liver_GO,Cluster:2   :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:kidney_GO,Cluster:2  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:pancreas_GO,Cluster:2:Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:liver_GO,Cluster:3   :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:pancreas_GO,Cluster:3:Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:kidney_GO,Cluster:4  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:muscle_GO,Cluster:4  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:pancreas_GO,Cluster:4:Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:spleen_GO,Cluster:4  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:muscle_GO,Cluster:5  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:pancreas_GO,Cluster:5:Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:spleen_GO,Cluster:5  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:muscle_GO,Cluster:6  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:pancreas_GO,Cluster:6:Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots
 $ Data:spleen_GO,Cluster:6  :Formal class 'EnrichGT_obj' [package "EnrichGT"] with 12 slots</code></pre>
</div>
</div>
</section>
<section id="ora-workflow" class="level3">
<h3 class="anchored" data-anchor-id="ora-workflow">ORA Workflow</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create reactor</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>ora_reactor <span class="ot">&lt;-</span> <span class="fu">egt_comparison_reactor</span>(<span class="st">"ORA"</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add results</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(control_ora, <span class="st">"control"</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(treatment1_ora, <span class="st">"treatment1"</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(treatment2_ora, <span class="st">"treatment2"</span>)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and compare</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">prefilter_by_p_adj</span>(<span class="fl">0.01</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">make_plans</span>(<span class="at">group =</span> <span class="st">"auto"</span>, <span class="at">use_value =</span> <span class="st">"padj"</span>)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze relationships</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">find_relationship</span>(<span class="at">Num =</span> <span class="dv">10</span>)</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>relation_data <span class="ot">&lt;-</span> ora_reactor<span class="sc">$</span><span class="fu">fetch_relationship</span>()</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize themes</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>themes <span class="ot">&lt;-</span> ora_reactor<span class="sc">$</span><span class="fu">fetch_biological_theme</span>()</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Refine clustering</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>ora_reactor<span class="sc">$</span><span class="fu">do_recluster</span>(<span class="at">ClusterNum =</span> <span class="dv">6</span>, <span class="at">P.adj =</span> <span class="fl">0.01</span>)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>refined_results <span class="ot">&lt;-</span> ora_reactor<span class="sc">$</span><span class="fu">get_recluster_result</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="gsea-workflow" class="level3">
<h3 class="anchored" data-anchor-id="gsea-workflow">GSEA Workflow</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create reactor</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>gsea_reactor <span class="ot">&lt;-</span> <span class="fu">egt_comparison_reactor</span>(<span class="st">"GSEA"</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add results</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(condition1_gsea, <span class="st">"condition1"</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">append_enriched_result</span>(condition2_gsea, <span class="st">"condition2"</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by significance and effect size</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">prefilter_by_p_adj</span>(<span class="fl">0.05</span>)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">prefilter_by_NES</span>(<span class="fl">1.5</span>)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare using NES</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">make_plans</span>(<span class="at">group =</span> <span class="st">"auto"</span>, <span class="at">use_value =</span> <span class="st">"NES"</span>)</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze patterns</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">find_relationship</span>(<span class="at">Num =</span> <span class="dv">20</span>, <span class="at">dist_method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>patterns <span class="ot">&lt;-</span> gsea_reactor<span class="sc">$</span><span class="fu">fetch_relationship</span>()</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine themes and refine</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>themes <span class="ot">&lt;-</span> gsea_reactor<span class="sc">$</span><span class="fu">fetch_biological_theme</span>()</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>gsea_reactor<span class="sc">$</span><span class="fu">do_recluster</span>(<span class="at">ClusterNum =</span> <span class="dv">8</span>, <span class="at">nTop =</span> <span class="dv">15</span>)</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>refined <span class="ot">&lt;-</span> gsea_reactor<span class="sc">$</span><span class="fu">get_recluster_result</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>EnrichGT</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ZhimingYe/EnrichGT_website/blob/main/compare.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/ZhimingYe/EnrichGT_website/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Version 2.2</p>
</div>
  </div>
</footer>




</body></html>