---
title: "Comparison of 2 enrichment results and further clustering"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Comparison of 2 enrichment results and further clustering}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(EnrichGT)
```

# Enrichment Result Comparing

`clusterProfiler` provides tools for comparing biological functions (`clusterProfiler::compareCluster()`), but its result granularity may not be detailed enough. Therefore, the `compareGT()` function offers a way to perform a more granular comparison between two specific enrichment results. The input objects are two ORA or GSEA results from different sources.

Some important distinctions to note:

1.  If you need to further enrich the results from `clusterProfiler::compareCluster()`, simply pass them to `EnrichGT()`, which will automatically recognize the multi-group comparison results from `clusterProfiler`, eliminating the need for the `compareGT()` function. The `compareGT()` function serves a different purpose; you need to provide two independently sourced results. `compareGT()` is designed to yield more granular results, providing a more precise view of biological process differences, while `clusterProfiler::compareCluster()` is suitable for multiple groups and provides a broader overview. `compareGT()` is limited to comparisons between only two groups.

2.  The primary focus of `compareGT()` is on comparing enrichment results from heterogeneous gene sets of different sources. If you want to integrate enrichment results from the same source but across different databases, use a `list()` to contain the enrichment results, such as `EnrichGT(list(a, b, c))`. `EnrichGT` will then automatically merge these results.

# Generate Data Sets

```{r}
suppressMessages({
  library(tidyverse)
  library(gt)
  library(clusterProfiler)
  library(org.Hs.eg.db)
  })
data(geneList, package="DOSE")
gene_up <- names(geneList)[(geneList) > 1]
gene_down <- names(geneList)[(geneList) < (-1)]
ego_up <- enrichGO(gene          = gene_up,
                  universe      = names(geneList),
                  OrgDb         = org.Hs.eg.db,
                  ont           = "BP",
                  pAdjustMethod = "BH",
                  pvalueCutoff  = 0.5,
                  qvalueCutoff  = 0.5,
                  readable      = TRUE)

ego_down <- enrichGO(gene          = gene_down,
                  universe      = names(geneList),
                  OrgDb         = org.Hs.eg.db,
                  ont           = "BP",
                  pAdjustMethod = "BH",
                  pvalueCutoff  = 0.5,
                  qvalueCutoff  = 0.5,
                  readable      = TRUE)
```

# Run compareGT

```{r}
dd<-compareGT(obj.test = ego_up,obj.ctrl = ego_down)
```

The result is a list, with 4 `Enrich_obj` objects with overlap and non-overlap gene sets in it. 

```{r}
str(dd,max.level = 2)
```

# Result Preview

## Overlap(in control)

```{r}
dd[["Overlap_Control"]]@gt_object
```

## Overlap(in Test group)

```{r}
dd[["Overlap_Test"]]@gt_object
```

## non-Overlap(in control)

```{r}
dd[["Control_Only"]]@gt_object
```

## non-Overlap(in Test group)

```{r}
dd[["Test_Only"]]@gt_object
```

# Session Info

```{r}
sessioninfo::session_info()
```


