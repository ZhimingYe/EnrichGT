---
title: "Clustering and viewing GSEA results"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Clustering and viewing GSEA results}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(EnrichGT)
```

# Summary

Similar to ORA, for GSEA enrichment analysis (What is GSEA enrichment analysis? See webpage: <https://yulab-smu.top/biomedical-knowledge-mining-book/enrichment-overview.html>), EnrichGT can read results from `gseaResult` generated by `clusterProfiler` or an exported table from clusterProfiler enrichment (including at least the columns "ID","Description","NES","pvalue","p.adjust" and "core_enrichment". `EnrichGT` performs term frequency statistics and automatic clustering based on genes enriched in hits, returns an S4 object, and outputs a beautifully formatted result wrapped by gt.


# Parsing GSEA results

This only shows results. For detailing usage, please see the Article of `ORA` (the before article). 

::: {.warning}
We encourage run `clusterProfiler::setReadable()` first before passing to `EnrichGT()`, to get gene symbols correctly (this is a bad example without `setReadable()`). 
:::

```{r}
suppressMessages({
  library(tidyverse)
  library(gt)
  library(clusterProfiler)
  library(org.Hs.eg.db)
  })
data(geneList, package="DOSE")
ego3 <- gseGO(geneList     = geneList,
                OrgDb        = org.Hs.eg.db,
                ont          = "CC",
                minGSSize    = 100,
                maxGSSize    = 500,
                pvalueCutoff = 0.05,
                verbose      = FALSE)
(EnrichGT(ego3, ClusterNum = 100, P.adj = 1)@gt_object)
```

After `setReadable()` was run: 

```{r}
ego3<-ego3 |> setReadable(OrgDb = org.Hs.eg.db,keyType = "ENTREZID")
(EnrichGT(ego3, ClusterNum = 100, P.adj = 1)@gt_object)
```

# Session info

```{r}
sessioninfo::session_info()
```

