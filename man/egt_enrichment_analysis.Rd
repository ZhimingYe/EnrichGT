% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cp_helpers.R
\name{egt_enrichment_analysis}
\alias{egt_enrichment_analysis}
\title{Perform Over-Representation Analysis (ORA)}
\usage{
egt_enrichment_analysis(
  genes,
  database,
  p_adj_methods = "BH",
  p_val_cut_off = 0.5,
  background_genes = NULL,
  min_geneset_size = 10,
  max_geneset_size = 500,
  multi_cores = 0
)
}
\arguments{
\item{genes}{Input genes, either:
\itemize{
  \item Character vector of gene IDs (e.g., `c("TP53","BRCA1")`)
  \item Named numeric vector from `genes_with_weights()` (will split by expression direction)
  \item List of gene vectors for multiple comparisons (e.g., by cell type)
}}

\item{database}{Gene set database, either:
\itemize{
  \item Built-in database from `database_GO_BP()`, `database_KEGG()` etc.
  \item Custom data frame with columns: (ID, Pathway_Name, Genes) or (Pathway_Name, Genes)
  \item GMT file loaded via `database_from_gmt()`
}}

\item{p_val_cut_off}{Adjusted p-value cutoff (default 0.5)}

\item{background_genes}{Custom background genes (default: all genes in database)}

\item{min_geneset_size}{Minimum genes per set (default 10)}

\item{max_geneset_size}{Maximum genes per set (default 500)}

\item{multi_cores}{(Please don't use this since it has several known bugs) Number of cores for parallel processing (default 0 = serial)}

\item{p_adj_method}{Multiple testing correction method (default "BH" for Benjamini-Hochberg)}
}
\value{
A data frame with columns:
  \itemize{
    \item ID: Gene set identifier
    \item Description: Gene set name  
    \item GeneRatio: Enriched genes / input genes
    \item BgRatio: Set genes / background genes
    \item pvalue: Raw p-value
    \item p.adjust: Adjusted p-value
    \item geneID: Enriched genes
    \item Count: Number of enriched genes
  }
  For weighted input, additional columns show up/down regulated genes.
}
\description{
ORA compares the proportion of genes in your target list that belong to specific
categories (pathways, GO terms etc.) against the expected proportion in a background
set. This implementation uses hash tables for efficient gene counting and supports
parallel processing for analyzing multiple gene lists.
}
\details{
Identifies enriched biological pathways or gene sets in a gene list using
high-performance C++ implementation with parallel processing support.
}
\examples{
\dontrun{
# Basic ORA with GO Biological Processes
genes <- c("TP53", "BRCA1", "EGFR", "CDK2")
res <- egt_enrichment_analysis(genes, database_GO_BP())

# ORA with DEG results (split by direction)
deg_genes <- genes_with_weights(DEG$gene, DEG$log2FC)
res <- egt_enrichment_analysis(deg_genes, database_KEGG())

# Multi-group ORA with parallel processing
gene_lists <- list(
  Macrophages = c("CD68", "CD163", "CD169"),
  Fibroblasts = c("COL1A1", "COL1A2", "ACTA2")
)
res <- egt_enrichment_analysis(gene_lists, database_Reactome(), multi_cores=0)
}
}
\author{
Zhiming Ye
}
