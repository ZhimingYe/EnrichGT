% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cp_helpers.R
\name{egt_gsea_analysis}
\alias{egt_gsea_analysis}
\title{Perform Gene Set Enrichment Analysis (GSEA)}
\usage{
egt_gsea_analysis(
  genes,
  database,
  p_val_cut_off = 0.5,
  min_geneset_size = 10,
  max_geneset_size = 500,
  gseaParam = 1
)
}
\arguments{
\item{genes}{A named numeric vector of ranked genes where:
\itemize{
  \item Names are gene identifiers
  \item Values are ranking metric (e.g., log2 fold change, PCA loading)
}
Must be sorted in descending order (use `genes_with_weights()` to prepare)}

\item{database}{Gene set database, either:
\itemize{
  \item Built-in database from `database_GO_BP()`, `database_KEGG()` etc.
  \item Custom data frame with columns: (ID, Pathway_Name, Genes) or (Pathway_Name, Genes)
  \item GMT file loaded via `database_from_gmt()`
}}

\item{p_val_cut_off}{Adjusted p-value cutoff (default 0.5)}

\item{min_geneset_size}{Minimum genes per set (default 10)}

\item{max_geneset_size}{Maximum genes per set (default 500)}

\item{gseaParam}{GSEA parameter controlling weight of ranking (default 1)}

\item{p_adj_method}{Multiple testing correction method (default "BH" for Benjamini-Hochberg)}
}
\value{
A data frame with columns:
  \itemize{
    \item ID: Gene set identifier
    \item Description: Gene set name
    \item ES: Enrichment score
    \item NES: Normalized enrichment score
    \item pvalue: Raw p-value
    \item p.adjust: Adjusted p-value
    \item core_enrichment: Leading edge genes
  }
}
\description{
GSEA analyzes whether predefined gene sets show statistically significant enrichment
at the top or bottom of a ranked gene list. This implementation uses the fast fgsea
algorithm from the fgsea package.
}
\details{
Identifies enriched biological pathways in a ranked gene list using the fgsea algorithm.
}
\examples{
\dontrun{
# Using differential expression results
ranked_genes <- genes_with_weights(DEG$gene, DEG$log2FC)
res <- egt_gsea_analysis(ranked_genes, database_GO_BP())

# Using PCA loadings
ranked_genes <- genes_with_weights(rownames(pca$rotation), pca$rotation[,1])
res <- egt_gsea_analysis(ranked_genes, database_KEGG())

# Custom gene sets from GMT file
ranked_genes <- genes_with_weights(genes, weights)
res <- egt_gsea_analysis(ranked_genes, database_from_gmt("pathways.gmt"))
}

}
\author{
Based on fgsea package by Alexey Sergushichev et al.
}
